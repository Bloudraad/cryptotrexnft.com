function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},i=e.parcelRequireb4d5;null==i&&((i=function(t){if(t in n)return n[t].exports;if(t in a){var e=a[t];delete a[t];var i={id:t,exports:{}};return n[t]=i,e.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){a[t]=e},e.parcelRequireb4d5=i);var o=i("cSnus"),s=i("2tNqr"),d=i("71KSP"),c=i("7VRcZ");async function r(e,n){const a=await async function(e,n){const a=await e.eth.getChainId(),i=new e.eth.Contract(t(o).abi,d.config[a].origin_address);return await i.methods.isApprovedForAll(n,d.config[a].migration_address).call({from:n})}(n,e);a?await m(e,n):await async function(){const t=document.getElementById("approvalView"),e=document.getElementById("migrationView");t.hidden=!1,e.hidden=!0;const n=await c.loadWeb3(),a=await c.web3Address(n),i=await n.eth.getChainId();if((await g(a,d.config[i].opensea_api,d.config[i].old_collection)).length<1){document.getElementById("warningNoTrex").hidden=!1}}()}let l=[];async function g(t,e,n){const a=`${e}/api/v1/assets?offset=0&limit=50&collection=${n}&owner=${t}`,i=await fetch(a);return(await i.json()).assets}async function m(e,n){const a=document.getElementById("approvalView"),i=document.getElementById("migrationView");a.hidden=!0,i.hidden=!1;const s=await n.eth.getChainId(),c=await g(e,d.config[s].opensea_api,d.config[s].old_collection),r=await async function(t,e,n){const a=`${e}/api/v1/assets?offset=0&limit=50&collection=${n}&owner=${t}`,i=await fetch(a);return(await i.json()).assets}(e,d.config[s].opensea_api,d.config[s].new_collection),m=document.querySelector("#card-list");if(n.currentProvider.isMetaMask){document.getElementById("addTokenBtn").hidden=!1}if(c.length<1){const t=document.getElementById("batchMigrateBtn");t.textContent="Nothing to migrate",t.classList="btn btn-light is-disabled",t.disabled=!0}if(c){const a=new n.eth.Contract(t(o).abi,d.config[s].origin_address);c.forEach((async t=>{l.push(t.token_id);const n=await a.methods.balanceOf(e,t.token_id).call({from:e});n&&n>0&&m.appendChild(p(t,!1))}))}r&&r.forEach((t=>{m.appendChild(p(t,!0))}))}function p(e,n){const a=document.createElement("div");a.classList="card",a.style="\n    margin: 4px;\n    background-color: #0a0a0a;\n    color: #fff;\n    border: 1px solid;\n    padding: 24px;\n    border-image-slice: 1;\n    border-image-source: linear-gradient(180deg, #d56730, #d5673041);";const i=document.createElement("a");i.href=e.permalink,i.target="_blank";const o=document.createElement("img");o.src=e.image_thumbnail_url,o.crossOrigin="anonymous",o.classList="card-img-top",i.appendChild(o);const r=document.createElement("div");r.classList="card-body";const l=document.createElement("h5");l.classList.add("card-title"),l.textContent=e.name;const g=document.createElement("button");g.type="button",n?(g.classList="btn btn-light disabled",g.disabled=!0,g.style="width: 100%",g.textContent="Migrated"):(g.classList="btn btn-secondary",g.style="font-weight: 800; width: 100%;",g.textContent="Migrate"),g.addEventListener("click",(()=>async function(e,n){const a=await c.loadWeb3(),i=await c.web3Address(a),o=await a.eth.getChainId(),r=a.utils.toBN(e);new a.eth.Contract(t(s).abi,d.config[o].migration_address).methods.migrate(r).send({from:i}).on("receipt",(()=>{n.disabled=!0,n.classList="btn btn-success",n.textContent="Migrated"})).on("transactionHash",(t=>{n.textContent="Migrating...",n.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${t}`,"_blank").focus()}))})).on("error",(()=>{n.disabled=!0,n.textContent="Failed",n.classList="btn btn-danger"}))}(e.token_id,g))),a.appendChild(i),r.appendChild(l),r.appendChild(g),a.appendChild(r);const m=document.createElement("div");return m.classList.add("col-md-3","col-xs-6","pb-1"),m.appendChild(a),m}document.getElementById("batchMigrateBtn").addEventListener("click",(async()=>{await async function(e){const n=await c.loadWeb3(),a=await c.web3Address(n),i=await n.eth.getChainId();let o=[];if(e.forEach((t=>{o.push(n.utils.toBN(t))})),o.length<1)return;const r=new n.eth.Contract(t(s).abi,d.config[i].migration_address),l=document.getElementById("batchMigrateBtn");r.methods.migrateBatch(o).send({from:a}).on("receipt",(()=>{l.disabled=!0,l.textContent="Migrated",l.classList="nes-btn is-success"})).on("transactionHash",(t=>{l.textContent="Migrating...",l.classList="nes-btn",l.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${t}`,"_blank").focus()}))})).on("error",(()=>{l.disabled=!0,l.textContent="Failed",l.classList="nes-btn is-error"}))}(l)})),window.onload=async()=>{try{const t=await c.loadWeb3(),e=await c.web3Address(t);c.switchChain(window.ethereum),r(e,t)}catch(t){console.log(t)}};document.getElementById("addTokenBtn").addEventListener("click",(async()=>{await async function(t){const e=await c.loadWeb3(),n=await e.eth.getChainId(),a=d.config[n].token_address;try{await t.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:a,symbol:"FOSSIL",decimals:18,image:"https://gateway.pinata.cloud/ipfs/QmZpPpnuASN7riY1UwVftSMowJAgMbf9x1k9pCaH5buSEQ"}}})}catch(t){console.log(t)}}(window.ethereum)}));document.getElementById("approveBtn").addEventListener("click",(async()=>{await async function(){const e=await c.loadWeb3(),n=await c.web3Address(e),a=await e.eth.getChainId();new e.eth.Contract(t(o).abi,d.config[a].origin_address).methods.setApprovalForAll(d.config[a].migration_address,!0).send({from:n}).on("receipt",(()=>{const t=document.getElementById("approveBtn");t.textContent="Approved",t.disabled=!0,t.classList="btn btn-success is-disabled",m(n,e)})).on("transactionHash",(t=>{const e=document.getElementById("approvalContainer"),n=document.createElement("a");n.classList="btn btn-info",n.href=`https://etherscan.io/tx/${t}`,n.target="_blank",n.text="View Transaction",e.appendChild(n);const a=document.getElementById("approveBtn");a.textContent="Approving...",a.disabled=!0,a.classList="btn btn-primary"}))}()}));
//# sourceMappingURL=migrate.092a2fd0.js.map
