function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},o=t.parcelRequireb4d5;null==o&&((o=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequireb4d5=o);var i=o("cSnus"),s=o("2tNqr"),c=o("71KSP"),d=o("7VRcZ"),r=o("6LYZy");async function l(t,n){const a=await async function(t,n){const a=await t.eth.getChainId(),o=new t.eth.Contract(e(i).abi,c.config[a].origin_address);return await o.methods.isApprovedForAll(n,c.config[a].migration_address).call({from:n})}(n,t);a?await m(t,n):await async function(){const e=document.getElementById("approvalView"),t=document.getElementById("migrationView");e.hidden=!1,t.hidden=!0;const n=await d.loadWeb3(),a=await d.web3Address(n),o=await n.eth.getChainId();if((await p(a,c.config[o].alchemy_api,c.config[o].origin_address)).length<1){document.getElementById("warningNoTrex").hidden=!1}}()}let g=[];async function p(e,t,n,a){const o=`${t}?owner=${e}&contractAddresses[]=${[n]}&collection=${a}`;console.log("ownerAddr, baseURL, contractAddr, collectionSlug:",o);const i=await fetch(o);return(await i.json()).ownedNfts.map((e=>{if(e.contract.address.toLowerCase()===n.toLowerCase())return e.id.tokenId}))}async function m(t,n){const a=document.getElementById("approvalView"),o=document.getElementById("migrationView");a.hidden=!0,o.hidden=!1;const s=await n.eth.getChainId(),d=await p(t,c.config[s].alchemy_api,c.config[s].origin_address,c.config[s].collection_slug),l=await p(t,c.config[s].alchemy_api,c.config[s].migration_address,c.config[s].collection_slug),g=document.querySelector("#card-list");if(n.currentProvider.isMetaMask){document.getElementById("addTokenBtn").hidden=!1}if(d){if(d.length<1){const e=document.getElementById("batchMigrateBtn");e.textContent="Nothing to migrate",e.classList="btn btn-light is-disabled",e.disabled=!0}new n.eth.Contract(e(i).abi,c.config[s].origin_address);d.forEach((async t=>{const n={method:"GET",headers:{accept:"application/json","x-api-key":c.config[s].opensea_api_key}},a=`${c.config[s].opensea_api}/api/v2/chain/ethereum/contract/${c.config[s].migration_address}/nfts/${e(r).utils.toBN(t)}`;console.log("Constructed URLv1:",a),console.log("Headers:",n.headers);try{const e=await fetch(a,n),t=await e.json();console.log("API Response Body:",t),console.log("NFT Image URL:",nft.image_url),g.appendChild(h(t,!1))}catch(e){console.error(e)}}))}if(l){const t={method:"GET",headers:{accept:"application/json","x-api-key":c.config[s].opensea_api_key}};l.forEach((async n=>{const a=`${c.config[s].opensea_api}/api/v2/chain/ethereum/contract/${c.config[s].migration_address}/nfts/${e(r).utils.toBN(n)}`;console.log("Constructed URL_v2:",a),console.log("Headers:",t.headers);try{const e=await fetch(a,t),n=await e.json();console.log("API Response Body:",n),g.appendChild(h(n,!0))}catch(e){console.error(e)}}))}}function h(t,n){const a=document.createElement("div");a.classList="card",a.style="\n    margin: 4px;\n    background-color: #0a0a0a;\n    color: #fff;\n    border: 1px solid;\n    padding: 24px;\n    border-image-slice: 1;\n    border-image-source: linear-gradient(180deg, #d56730, #d5673041);";const o=document.createElement("a");o.href=t.permalink,o.target="_blank";const i=document.createElement("img");i.onload=function(){console.log("Image loaded successfully:",i.src)},i.onerror=function(){console.error("Failed to load image:",i.src)},i.crossOrigin="anonymous",i.classList="card-img-top",o.appendChild(i),i.onload=function(){console.log("Image loaded successfully:",i.src)},i.onerror=function(){console.error("Failed to load image:",i.src)},i.src=t.nft.image_url,i.crossOrigin="anonymous",i.classList="card-img-top",o.appendChild(i);const r=document.createElement("div");r.classList="card-body";const l=document.createElement("h5");l.classList.add("card-title"),l.textContent=t.name;const g=document.createElement("button");g.type="button",n?(g.classList="btn btn-light disabled",g.disabled=!0,g.style="width: 100%",g.textContent="Migrated"):(g.classList="btn btn-secondary",g.style="font-weight: 800; width: 100%;",g.textContent="Migrate"),g.addEventListener("click",(()=>async function(t,n){const a=await d.loadWeb3(),o=await d.web3Address(a),i=await a.eth.getChainId(),r=a.utils.toBN(t);console.log("Token ID BigNumber:",r.toString()),new a.eth.Contract(e(s).abi,c.config[i].migration_address).methods.migrate(r).send({from:o}).on("receipt",(()=>{n.disabled=!0,n.classList="btn btn-success",n.textContent="Migrated"})).on("transactionHash",(e=>{n.textContent="Migrating...",n.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${e}`,"_blank").focus()}))})).on("error",(()=>{n.disabled=!0,n.textContent="Failed",n.classList="btn btn-danger"}))}(t.token_id,g))),a.appendChild(o),r.appendChild(l),r.appendChild(g),a.appendChild(r);const p=document.createElement("div");return p.classList.add("col-md-3","col-xs-6","pb-1"),p.appendChild(a),p}document.getElementById("batchMigrateBtn").addEventListener("click",(async()=>{await async function(t){const n=await d.loadWeb3(),a=await d.web3Address(n),o=await n.eth.getChainId();let i=[];if(t.forEach((e=>{i.push(n.utils.toBN(e))})),i.length<1)return;const r=new n.eth.Contract(e(s).abi,c.config[o].migration_address),l=document.getElementById("batchMigrateBtn");r.methods.migrateBatch(i).send({from:a}).on("receipt",(()=>{l.disabled=!0,l.textContent="Migrated",l.classList="nes-btn is-success"})).on("transactionHash",(e=>{l.textContent="Migrating...",l.classList="nes-btn",l.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${e}`,"_blank").focus()}))})).on("error",(()=>{l.disabled=!0,l.textContent="Failed",l.classList="nes-btn is-error"}))}(g)})),window.onload=async()=>{try{const e=await d.loadWeb3(),t=await d.web3Address(e);d.switchChain(window.ethereum),l(t,e)}catch(e){console.log(e)}};document.getElementById("addTokenBtn").addEventListener("click",(async()=>{await async function(e){const t=await d.loadWeb3(),n=await t.eth.getChainId(),a=c.config[n].token_address;try{await e.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:a,symbol:"FOSSIL",decimals:18,image:"https://gateway.pinata.cloud/ipfs/QmZpPpnuASN7riY1UwVftSMowJAgMbf9x1k9pCaH5buSEQ"}}})}catch(e){console.log(e)}}(window.ethereum)}));document.getElementById("approveBtn").addEventListener("click",(async()=>{await async function(){const t=await d.loadWeb3(),n=await d.web3Address(t),a=await t.eth.getChainId();new t.eth.Contract(e(i).abi,c.config[a].origin_address).methods.setApprovalForAll(c.config[a].migration_address,!0).send({from:n}).on("receipt",(()=>{const e=document.getElementById("approveBtn");e.textContent="Approved",e.disabled=!0,e.classList="btn btn-success is-disabled",m(n,t)})).on("transactionHash",(e=>{const t=document.getElementById("approvalContainer"),n=document.createElement("a");n.classList="btn btn-info",n.href=`https://etherscan.io/tx/${e}`,n.target="_blank",n.text="View Transaction",t.appendChild(n);const a=document.getElementById("approveBtn");a.textContent="Approving...",a.disabled=!0,a.classList="btn btn-primary"}))}()}));
//# sourceMappingURL=migrate.ba4cc53b.js.map
