function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},a=t.parcelRequireb4d5;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},t.parcelRequireb4d5=a);var i=a("cSnus"),s=a("2tNqr"),c=a("71KSP"),d=a("7VRcZ"),r=a("6LYZy");async function l(t,n){const o=await async function(t,n){const o=await t.eth.getChainId(),a=new t.eth.Contract(e(i).abi,c.config[o].origin_address);return await a.methods.isApprovedForAll(n,c.config[o].migration_address).call({from:n})}(n,t);console.log("approved :",o),o?await h(t,n):await async function(){const e=document.getElementById("approvalView"),t=document.getElementById("migrationView");e.hidden=!1,t.hidden=!0;const n=await d.loadWeb3(),o=await d.web3Address(n),a=await n.eth.getChainId(),i=await p(o,c.config[a].alchemy_api,c.config[a].origin_address,c.config[a].collection_slug);if(console.log("Length of v1 array:",i.length),i.length<1){document.getElementById("warningNoTrex").hidden=!1}}()}let g=[];async function p(e,t,n,o){const a=`${t}?owner=${e}&contractAddresses[]=${[n]}&collection=${o}`;console.log("ownerAddr, baseURL, contractAddr, collectionSlug:",a);const i=await fetch(a);return(await i.json()).ownedNfts.map((e=>{if(e.contract.address.toLowerCase()===n.toLowerCase())return e.id.tokenId}))}async function h(t,n){const o=document.getElementById("approvalView"),a=document.getElementById("migrationView");o.hidden=!0,a.hidden=!1;const s=await n.eth.getChainId(),d=await p(t,c.config[s].alchemy_api,c.config[s].origin_address,c.config[s].collection_slug),l=await p(t,c.config[s].alchemy_api,c.config[s].migration_address,c.config[s].collection_slug),g=document.querySelector("#card-list");if(n.currentProvider.isMetaMask){document.getElementById("addTokenBtn").hidden=!1}const h=await n.eth.getChainId(),u=c.config[h].origin_address,f=`${c.config[h].opensea_api}/api/v2/chain/ethereum/contract/${u}/nfts/`;if(console.log("Constructed URL for v1:",f),d){if(d.length<1){const e=document.getElementById("batchMigrateBtn");e.textContent="Nothing to migrate",e.classList="btn btn-light is-disabled",e.disabled=!0}new n.eth.Contract(e(i).abi,c.config[s].origin_address);d.forEach((async t=>{const n={method:"GET",headers:{accept:"application/json","x-api-key":c.config[s].opensea_api_key}},o=`${c.config[s].opensea_api}/api/v2/chain/ethereum/contract/${c.config[s].origin_address}/nfts/${e(r).utils.toBN(t)}`;console.log("Constructed URLv1:",o),console.log("Headers:",n.headers);try{const e=await fetch(o,n),t=await e.json();console.log("API Response Body:",t),console.log("NFT Image URL:",nft.image_url),g.appendChild(m(t,!1))}catch(e){console.error(e)}}))}if(l){const t={method:"GET",headers:{accept:"application/json","x-api-key":c.config[s].opensea_api_key}};l.forEach((async n=>{const o=`${c.config[s].opensea_api}/api/v2/chain/ethereum/contract/${c.config[s].migration_address}/nfts/${e(r).utils.toBN(n)}`;console.log("Constructed URL_v2:",o),console.log("Headers:",t.headers);try{const e=await fetch(o,t),n=await e.json();console.log("API Response Body:",n),g.appendChild(m(n,!0))}catch(e){console.error(e)}}))}}function m(t,n){const o=document.createElement("div");o.classList="card",o.style="\n    margin: 4px;\n    background-color: #0a0a0a;\n    color: #fff;\n    border: 1px solid;\n    padding: 24px;\n    border-image-slice: 1;\n    border-image-source: linear-gradient(180deg, #d56730, #d5673041);";const a=document.createElement("a");a.href=t.permalink,a.target="_blank";const i=document.createElement("img");i.onload=function(){console.log("Image loaded successfully:",i.src)},i.onerror=function(){console.error("Failed to load image:",i.src)},i.crossOrigin="anonymous",i.classList="card-img-top",a.appendChild(i),i.onload=function(){console.log("Image loaded successfully:",i.src)},i.onerror=function(){console.error("Failed to load image:",i.src)},i.src=t.nft.image_url,i.crossOrigin="anonymous",i.classList="card-img-top",a.appendChild(i);const r=document.createElement("div");r.classList="card-body";const l=document.createElement("h5");l.classList.add("card-title"),l.textContent=t.name;const g=document.createElement("button");g.type="button",n?(g.classList="btn btn-light disabled",g.disabled=!0,g.style="width: 100%",g.textContent="Migrated"):(g.classList="btn btn-secondary",g.style="font-weight: 800; width: 100%;",g.textContent="Migrate"),g.addEventListener("click",(()=>async function(t,n){const o=await d.loadWeb3(),a=await d.web3Address(o),i=await o.eth.getChainId(),r=o.utils.toBN(t);console.log("Token ID BigNumber:",r.toString()),new o.eth.Contract(e(s).abi,c.config[i].migration_address).methods.migrate(r).send({from:a}).on("receipt",(()=>{n.disabled=!0,n.classList="btn btn-success",n.textContent="Migrated"})).on("transactionHash",(e=>{n.textContent="Migrating...",n.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${e}`,"_blank").focus()}))})).on("error",(()=>{n.disabled=!0,n.textContent="Failed",n.classList="btn btn-danger"}))}(t.token_id,g))),o.appendChild(a),r.appendChild(l),r.appendChild(g),o.appendChild(r);const p=document.createElement("div");return p.classList.add("col-md-3","col-xs-6","pb-1"),p.appendChild(o),p}document.getElementById("batchMigrateBtn").addEventListener("click",(async()=>{await async function(t){const n=await d.loadWeb3(),o=await d.web3Address(n),a=await n.eth.getChainId();let i=[];if(t.forEach((e=>{i.push(n.utils.toBN(e))})),i.length<1)return;const r=new n.eth.Contract(e(s).abi,c.config[a].migration_address),l=document.getElementById("batchMigrateBtn");r.methods.migrateBatch(i).send({from:o}).on("receipt",(()=>{l.disabled=!0,l.textContent="Migrated",l.classList="nes-btn is-success"})).on("transactionHash",(e=>{l.textContent="Migrating...",l.classList="nes-btn",l.addEventListener("click",(()=>{window.open(`https://etherscan.io/tx/${e}`,"_blank").focus()}))})).on("error",(()=>{l.disabled=!0,l.textContent="Failed",l.classList="nes-btn is-error"}))}(g)})),window.onload=async()=>{try{const e=await d.loadWeb3(),t=await d.web3Address(e);d.switchChain(window.ethereum),l(t,e)}catch(e){console.log(e)}};document.getElementById("addTokenBtn").addEventListener("click",(async()=>{await async function(e){const t=await d.loadWeb3(),n=await t.eth.getChainId(),o=c.config[n].token_address;try{await e.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:o,symbol:"FOSSIL",decimals:18,image:"https://gateway.pinata.cloud/ipfs/QmZpPpnuASN7riY1UwVftSMowJAgMbf9x1k9pCaH5buSEQ"}}})}catch(e){console.log(e)}}(window.ethereum)}));document.getElementById("approveBtn").addEventListener("click",(async()=>{await async function(){const t=await d.loadWeb3(),n=await d.web3Address(t),o=await t.eth.getChainId();new t.eth.Contract(e(i).abi,c.config[o].origin_address).methods.setApprovalForAll(c.config[o].migration_address,!0).send({from:n}).on("receipt",(()=>{const e=document.getElementById("approveBtn");e.textContent="Approved",e.disabled=!0,e.classList="btn btn-success is-disabled",h(n,t)})).on("transactionHash",(e=>{const t=document.getElementById("approvalContainer"),n=document.createElement("a");n.classList="btn btn-info",n.href=`https://etherscan.io/tx/${e}`,n.target="_blank",n.text="View Transaction",t.appendChild(n);const o=document.getElementById("approveBtn");o.textContent="Approving...",o.disabled=!0,o.classList="btn btn-primary"}))}()}));
//# sourceMappingURL=migrate.c8cadac6.js.map
